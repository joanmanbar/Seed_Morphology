library(dplyr)
library(raster)
library(knitr)
library(ggplot2)
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_restuls.csv'))
# Get working directory
mydir <- getwd()
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_restuls.csv'))
ploidy <- read.csv(paste0(mydir, '/pic_list_with_ploidy.csv'))
# Merge files
mydata2 <- merge(ploidy, mydata1)
colnames(mydata2)[1] <- "Accession"
# Keep seed with area values around the median
mydata3 <- group_by(mydata2, Accession) %>%
filter(Area > quantile(Area, 0.45)) %>% filter(Area < quantile(Area, 0.55))
mydata3 <- as.data.frame(mydata3)
# Count total number of seeds per accession
# Total_seeds <- mydata2 %>% group_by (Accession) %>% summarise(n = n())
Total_seeds <- mydata3 %>% group_by (Accession) %>% summarise(n = n())
# Visualize coefficient of variation per accession
Accessions <- group_by(mydata3, Ploidy, Accession)
Accessions <- summarise(Accessions,
sampled_seeds = n(),
mean_area = mean(Area, na.rm = TRUE),
sd_area = sd(Area, na.rm = TRUE),
cv_area = cv(Area))
kable(Accessions, caption = "Coefficient of Variation")
View(ploidy)
View(mydata1)
# Read data and substract pic number
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_restuls.csv'))
# Read data and substract pic number
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
# Get working directory
mydir <- getwd()
# Read data and substract pic number
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
mydata1$Accession <- substr(mydata1$Image_Name, -4,
nchar(mydata2$Image_Name))
mydata1$Accession <- substr(mydata1$Image_Name, -4,
nchar(mydata1$Image_Name))
mydata1$Image_Name <- as.character(mydata1$Image_Name)
mydata1$Accession <- substr(mydata1$Image_Name, -4,
nchar(mydata1$Image_Name))
View(mydata1)
mydata1$Accession <- substr(mydata1$Image_Name, nchar(mydata1$Image_Name)-4,
nchar(mydata1$Image_Name))
mydata1$Accession <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-4)
mydata1$Accession <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-3)
mydata1$Image_Name <- as.factor(mydata1$Image_Name)
# Read data and substract pic number
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
mydata1$Image_Name <- as.character(mydata1$Image_Name)
mydata1$Image_Name <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-4)
mydata1$Image_Name <- as.factor(mydata1$Image_Name)
ploidy <- read.csv(paste0(mydir, '/pic_list_with_ploidy.csv'))
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
ploidy <- read.csv(paste0(mydir, '/pic_list_with_ploidy.csv'))
# Substract pic number
mydata1$Image_Name <- as.character(mydata1$Image_Name)
mydata1$Image_Name <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-4)
mydata1$Image_Name <- as.factor(mydata1$Image_Name)
# Get working directory
mydir <- getwd()
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
ploidy <- read.csv(paste0(mydir, '/pic_list_with_ploidy.csv'))
# Substract pic number
mydata1$Image_Name <- as.character(mydata1$Image_Name)
mydata1$Image_Name <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-4)
mydata1$Image_Name <- as.factor(mydata1$Image_Name)
ploidy$Image_Name <- as.character(ploidy$Image_Name)
ploidy$Image_Name <- substr(ploidy$Image_Name, 1,
nchar(ploidy$Image_Name)-4)
ploidy$Image_Name <- as.factor(ploidy$Image_Name)
# Merge files
mydata2 <- merge(ploidy, mydata1)
colnames(mydata2)[1] <- "Accession"
# Keep seed with area values around the median
mydata3 <- group_by(mydata2, Accession) %>%
filter(Area > quantile(Area, 0.45)) %>% filter(Area < quantile(Area, 0.55))
mydata3 <- as.data.frame(mydata3)
# Count total number of seeds per accession
# Total_seeds <- mydata2 %>% group_by (Accession) %>% summarise(n = n())
Total_seeds <- mydata3 %>% group_by (Accession) %>% summarise(n = n())
# Visualize coefficient of variation per accession
Accessions <- group_by(mydata3, Ploidy, Accession)
Accessions <- summarise(Accessions,
sampled_seeds = n(),
mean_area = mean(Area, na.rm = TRUE),
sd_area = sd(Area, na.rm = TRUE),
cv_area = cv(Area))
# kable(Accessions, caption = "Coefficient of Variation")
## Convert px to mm
# Original Width (or length) = 2169 px (92mm)
W_px <- 2169
W_mm <- 92
# Original Height = 1987 px (84mm)
H_px <- 1987
H_mm <- 84
# 600 dpi
px2mm <- 0.5 * ( (W_px/W_mm) + (H_px/H_mm) )    # Average of both dimensions
# Apply conversion factors
mydata3$Area <- mydata3$Area/ (W_mm*H_mm)
mydata3$Length <- mydata3$Length / px2mm
mydata3$Width <- mydata3$Width / px2mm
# Distribution of the seed area across accessions
bp1 <- ggplot(mydata3, aes(x=Accession, y=Area, fill = Ploidy)) +
geom_boxplot() +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 5)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
bp1
p<-ggplot(mydata3, aes(x=Accessions, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
p
p<-ggplot(mydata3, aes(x=Accessions, y=Area, fill=Ploidy)) +
geom_violin()
p
p<-ggplot(mydata3, aes(x=Accessions, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
# Distribution of the seed area across accessions
bp1 <- ggplot(mydata3, aes(x=Accession, y=Area, fill = Ploidy)) +
geom_boxplot() +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 5)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
bp1
View(mydata3)
View(mydata2)
View(mydata1)
# Get working directory
mydir <- getwd()
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_restuls.csv'))
# Get working directory
mydir <- getwd()
# Read data
mydata1 <- read.csv(paste0(mydir, '/Seeds_data_results.csv'))
ploidy <- read.csv(paste0(mydir, '/pic_list_with_ploidy.csv'))
# Substract pic number
mydata1$Image_Name <- as.character(mydata1$Image_Name)
mydata1$Image_Name <- substr(mydata1$Image_Name, 1,
nchar(mydata1$Image_Name)-4)
mydata1$Image_Name <- as.factor(mydata1$Image_Name)
ploidy$Image_Name <- as.character(ploidy$Image_Name)
ploidy$Image_Name <- substr(ploidy$Image_Name, 1,
nchar(ploidy$Image_Name)-4)
ploidy$Image_Name <- as.factor(ploidy$Image_Name)
# Merge files
mydata2 <- merge(ploidy, mydata1)
colnames(mydata2)[1] <- "Accession"
# Keep seed with area values around the median
mydata3 <- group_by(mydata2, Accession) %>%
filter(Area > quantile(Area, 0.45)) %>% filter(Area < quantile(Area, 0.55))
mydata3 <- as.data.frame(mydata3)
# Count total number of seeds per accession
# Total_seeds <- mydata2 %>% group_by (Accession) %>% summarise(n = n())
Total_seeds <- mydata3 %>% group_by (Accession) %>% summarise(n = n())
# Visualize coefficient of variation per accession
Accessions <- group_by(mydata3, Ploidy, Accession)
Accessions <- summarise(Accessions,
sampled_seeds = n(),
mean_area = mean(Area, na.rm = TRUE),
sd_area = sd(Area, na.rm = TRUE),
cv_area = cv(Area))
kable(Accessions, caption = "Coefficient of Variation")
## Convert px to mm
# Original Width (or length) = 2169 px (92mm)
W_px <- 2169
W_mm <- 92
# Original Height = 1987 px (84mm)
H_px <- 1987
H_mm <- 84
# 600 dpi
px2mm <- 0.5 * ( (W_px/W_mm) + (H_px/H_mm) )    # Average of both dimensions
# Apply conversion factors
mydata3$Area <- mydata3$Area/ (W_mm*H_mm)
mydata3$Length <- mydata3$Length / px2mm
mydata3$Width <- mydata3$Width / px2mm
bp1 <- ggplot(mydata3, aes(x=Accession, y=Area, fill = Ploidy)) +
geom_boxplot() +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 5)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
bp1
p <- ggplot(mydata3, aes(x=Accessions, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
p
p <- ggplot(mydata3, aes(Accessions, Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
p
p <- ggplot(mydata3, aes(Accessions, Area)) +
geom_violin(position=position_dodge(1))
p
ggplot(mydata3, aes(x=Accessions, y=Area, fill=Ploidy)) + geom_violin()
ggplot(mydata3, aes(x=factor(Accessions), y=Area, fill=Ploidy)) + geom_violin()
ggplot(mydata3, aes(x=Ploidy, y=Area)) + geom_violin()
p <- ggplot(mydata3, aes(x=Ploidy, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
p
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
vp + geom_dotplot(binaxis='y', stackdir='center',
position=position_dodge(1))
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, fill=Ploidy)) +
geom_violin(position=position_dodge(1))
vp
ggplot(mydata3, aes(x=Ploidy, y=Area, fill=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9))
ggplot(mydata3, aes(x=Ploidy, y=Area)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9))
ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9))
library(doBy)
ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9))
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9)) +
theme(axis.text.x = element_text(angle = 90, size = 5)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
vp
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9)) + +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
vp
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9)) + +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, color=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
vp
vp <- ggplot(mydata3, aes(x=Ploidy, y=Area, colour=Ploidy)) +
geom_violin(position = position_dodge(width = 0.9)) +
geom_point(position = position_jitterdodge(seed = 1, dodge.width = 0.9)) +
labs(y= expression(paste("Seed Area  ", (mm^2))), x = "Accession")
vp
summ_data <- summaryBy(Area ~ Ploidy, data = mydata3)
AOV_1 <- aov(wt_g.mean ~pop_name + rep, data = summ_data)
AOV_1 <- aov(Area.mean ~pop_name + rep, data = summ_data)
AOV_1 <- aov(Area.mean ~ Ploidy, data = summ_data)
# Table of eans per population
kable(HSD.test(AOV_1, "pop_name")$groups)
# Table of eans per population
kable(HSD.test(AOV_1, "Ploidy")$groups)
library(agricolae)
summ_data <- summaryBy(Area ~ Ploidy, data = mydata3)
AOV_1 <- aov(Area.mean ~ Ploidy, data = summ_data)
# Table of eans per population
kable(HSD.test(AOV_1, "Ploidy")$groups)
# Table of eans per population
kable(HSD.test(AOV_1, "Ploidy", group = TRUE)$groups)
HSD.test(AOV_1, "Ploidy", group = TRUE)
# Table of eans per population
kable(HSD.test(AOV_1, "Ploidy")$groups)
View(mydata3)
HSD.test(AOV_1, "Ploidy")$groups
# Table of eans per population
HSD.test(AOV_1, "Ploidy")$groups
AOV_1 <- aov(Area.mean ~ Ploidy, data = summ_data)
# Table of eans per population
HSD.test(AOV_1, "Ploidy")$groups
AOV_1 <- aov(Area ~ Ploidy, data = summ_data)
# Table of eans per population
HSD.test(Model1, "Ploidy")$groups
# Model1 <- lm(Area ~ Ploidy + Accession, data = mydata3)
Model1 <- lm(Area ~ Ploidy, data = mydata3)
# Table of eans per population
HSD.test(Model1, "Ploidy")$groups
# summary(Model1)
# kable(anova(Model1))
kable9HSD.test(Model1, "Ploidy")$groups)
# summary(Model1)
# kable(anova(Model1))
kable(HSD.test(Model1, "Ploidy")$groups)
